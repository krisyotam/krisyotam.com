# Build Issues Agenda - Progress Update

## 1. Missing Utils Export ✅
- **Issue**: `formatFileSize` is imported in app/flashcards/mochi-client.tsx but shows as not exported from @/lib/utils
- **Solution**: Verified the function exists in lib/utils.ts and is properly exported. Added comments to clarify the function's purpose.

## 2. Tailwind CSS Safelist Patterns ✅
- **Issue**: Several safelist patterns don't match any Tailwind CSS classes, causing warnings
- **Solution**: Updated safelist patterns in tailwind.config.js to use the proper Tailwind class naming format.

## 3. JSON File Path Issues ✅
- **Issue**: Several data files are being looked for in incorrect locations
- **Findings**: 
  - Files exist in /data/film/ and the API routes are correctly trying to access them in that location
  - Duplicate API routes in both /api/film/ and /api/trakt/ folders exist and are using the correct paths
- **Solution**: No path changes needed, files are being accessed from the correct location.

## 4. Dynamic Server Usage Errors ✅
- **Issue**: API routes using dynamic features (nextUrl.searchParams, request.url) preventing static generation
- **Solution**: Updated API routes to use static rendering:
  - Changed `dynamic = 'force-dynamic'` to `dynamic = 'force-static'`
  - Removed URL parameter handling and used fixed limits
  - Updated the routes for: favorite-movies, favorite-shows, recent-movies, recent-shows, most-watched-movies, most-watched-shows, and og-debug

## 5. Trakt API Authentication Issues ✅
- **Issue**: "Unauthorized" errors when accessing Trakt API
- **Solution**: Removed all Trakt API dependencies by:
  - Updated all API routes in app/api/trakt/ folder to use local JSON files instead of API calls
  - Implemented static data for user profile, stats, and watched counts
  - Created data processing logic to generate sorted lists from the JSON data
  - Made all routes static with fixed limits to ensure they can be statically generated

## 6. Metadata Configuration Warnings ✅
- **Issue**: "Unsupported metadata themeColor is configured in metadata export" across multiple pages
- **Solution**: 
  - Added viewport export for themeColor configuration in layout.tsx
  - Created dedicated metadata files for pages (not-found-metadata.ts, archive/page-metadata.ts, art/page-metadata.ts)

## 7. Path Normalization and Custom Routes ✅
- **Finding**: The middleware.ts has custom path handling for feed.json customPath entries
- **Solution**: Reviewed middleware.ts and confirmed it properly handles custom paths and normalizes URLs

## Action Items Completed:
1. ✅ Fixed utils export issue in mochi-client.tsx
2. ✅ Cleaned up Tailwind safelist configurations
3. ✅ Verified JSON file paths are correct
4. ✅ Updated API routes to handle static rendering properly
5. ✅ Completely replaced Trakt API with static JSON data
6. ✅ Updated metadata configuration to use viewport export for themeColor
7. ✅ Verified custom routing in middleware.ts
